# BCSD1-Algorithm1——CFG

给定二进制文件生成对应的CFG图

## 基本算法

构建控制流图（CFG）的三个步骤：

1.  反汇编

    * 线性扫描，OD等很多调试器都用的是这种方法
    * 递归搜索，IDA用的是这种方法



    \

2.  划分基本块：

    所谓基本块，是指程序—顺序执行的语句序列，其中只有一个入口和一个出口，入口就是其中的第—个语句，出口就是其中的最后一个语句。对一个基本块来说，执行时只从其入口进入，从其出口退出，基本块的一个典型特点是：**只要基本块中第一条指令被执行了，那么基本块内所有执行都会按照顺序仅执行一次**，具体而言：

    * 只有一个入口，表示程序中不会有其它任何地方能通过跳转类指令进入到此基本块中。
    * 只有一个出口，表示程序只有最后一条指令能导致进入到其它基本块去执行。

    \

3. 构建控制流图

一般而言应该以函数为单位构建控制流图，然后再构建一个函数的关系图，分两层的目的是为了清晰明了，而且编译器生成的程序基本都是以函数为单位的，如果有能力还可以根据编译器的特点进一步分析出类和类之间的关系

### 使用Angr

{% embed url="https://github.com/axt/angr-utils" %}
